<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia de Estudos: Containers na AWS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .prose {
            max-width: 80ch; /* Limita a largura para melhor legibilidade */
        }
        .prose h1, .prose h2, .prose h3, .prose h4 {
            font-weight: 700;
        }
        .prose p {
            line-height: 1.7;
        }
        .prose code {
            color: #d63384;
            background-color: #f8f9fa;
            padding: 0.2em 0.4em;
            border-radius: 6px;
        }
        .prose pre {
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: #4a5568;
            color: white;
            padding: 0.5rem;
            border-radius: 0.375rem;
            cursor: pointer;
            opacity: 0.5;
            transition: all 0.2s ease-in-out;
        }
        .prose pre:hover .copy-btn {
            opacity: 1;
        }
        .copy-btn-icon .fa-check {
            display: none;
        }
        .copy-btn-icon.copied .fa-copy {
            display: none;
        }
        .copy-btn-icon.copied .fa-check {
            display: inline-block;
        }
        .sidebar-link.active {
            background-color: #4f46e5;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="flex h-screen bg-gray-200">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 text-gray-100 flex-shrink-0" id="sidebar">
            <div class="p-4">
                <h1 class="text-xl font-bold text-white">Guia AWS Containers</h1>
            </div>
            <nav class="mt-4 text-sm" id="nav-menu">
                <a href="#modulo1" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-book-open w-6"></i> M√≥dulo 1: Fundamentos
                </a>
                <a href="#modulo2" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-server w-6"></i> M√≥dulo 2: EC2
                </a>
                <a href="#modulo3" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-box-archive w-6"></i> M√≥dulo 3: ECR
                </a>
                <a href="#modulo4" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-sitemap w-6"></i> M√≥dulo 4: ECS + EC2
                </a>
                <a href="#modulo5" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-chart-line w-6"></i> M√≥dulo 5: Auto Scaling
                </a>
                <a href="#modulo6" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fab fa-github-alt w-6"></i> M√≥dulo 6: CI/CD
                </a>
                <a href="#modulo7" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-cloud w-6"></i> M√≥dulo 7: Fargate
                </a>
                <a href="#modulo8" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white">
                    <i class="fas fa-palette w-6"></i> M√≥dulo 8: Deploy Avan√ßado
                </a>
            </nav>
        </aside>

        <!-- Main content -->
        <main class="flex-1 overflow-y-auto bg-white p-6 md:p-10">
            <div class="prose mx-auto">
                <section id="modulo1" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üìò M√≥dulo 1: Fundamentos de Containers e Docker</h2>

                    <h3 class="text-2xl font-semibold mt-6">1.1 O que √© um Container? Diferen√ßas entre VM e Container</h3>
                    <p><strong>M√°quina Virtual (VM)</strong>: Virtualiza o hardware f√≠sico. Executa um sistema operacional completo (Guest OS) sobre um hypervisor.</p>
                    <ul>
                        <li><strong>Vantagens</strong>: Isolamento robusto, compatibilidade com diferentes sistemas operacionais.</li>
                        <li><strong>Desvantagens</strong>: Consumo elevado de recursos (CPU, RAM, armazenamento), inicializa√ß√£o lenta.</li>
                    </ul>
                    <p><strong>Container</strong>: Virtualiza o sistema operacional (compartilha o kernel do host). Cont√©m apenas a aplica√ß√£o e suas depend√™ncias.</p>
                     <ul>
                        <li><strong>Vantagens</strong>: Leve (MBs vs GBs), inicializa√ß√£o r√°pida, alta portabilidade.</li>
                        <li><strong>Desvantagens</strong>: Menor isolamento (kernel compartilhado).</li>
                    </ul>
                    
                    <h4 class="text-xl font-semibold mt-4">Tabela Comparativa</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="py-2 px-4 border">Caracter√≠stica</th>
                                    <th class="py-2 px-4 border">M√°quina Virtual (VM)</th>
                                    <th class="py-2 px-4 border">Container</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td class="border px-4 py-2"><strong>Abstra√ß√£o</strong></td><td class="border px-4 py-2">Hardware</td><td class="border px-4 py-2">Sistema Operacional</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Isolamento</strong></td><td class="border px-4 py-2">Completo (n√≠vel HW)</td><td class="border px-4 py-2">Forte (n√≠vel processo)</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Tamanho</strong></td><td class="border px-4 py-2">Gigabytes (GBs)</td><td class="border px-4 py-2">Megabytes (MBs)</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Tempo de In√≠cio</strong></td><td class="border px-4 py-2">Minutos</td><td class="border px-4 py-2">Segundos</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Consumo de Recursos</strong></td><td class="border px-4 py-2">Alto (SO completo)</td><td class="border px-4 py-2">Baixo (kernel compartilhado)</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Portabilidade</strong></td><td class="border px-4 py-2">Limitada (depende do hypervisor)</td><td class="border px-4 py-2">Alt√≠ssima (Docker)</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h3 class="text-2xl font-semibold mt-8">1.2 Estrutura de uma Imagem Docker</h3>
                    <ul>
                        <li><strong>Imagem Docker</strong>: "Blueprint" imut√°vel contendo c√≥digo, runtime, bibliotecas e configura√ß√µes.</li>
                        <li><strong>Camadas (Layers)</strong>: Cada instru√ß√£o no Dockerfile cria uma nova camada.</li>
                        <li><strong>Union File System</strong>: Combina camadas em um √∫nico sistema de arquivos.</li>
                        <li><strong>Benef√≠cios</strong>:
                            <ul>
                                <li><strong>Efici√™ncia</strong>: Camadas s√£o compartilhadas entre diferentes imagens.</li>
                                <li><strong>Cache</strong>: Reutiliza camadas em builds subsequentes, acelerando o processo.</li>
                                <li><strong>Versionamento</strong>: Um hash SHA256 garante a integridade e o versionamento de cada camada.</li>
                            </ul>
                        </li>
                    </ul>

                    <h3 class="text-2xl font-semibold mt-8">1.3 Dockerfile: Comandos Essenciais</h3>
                    <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-auto"><button class="copy-btn"><span class="copy-btn-icon"><i class="fas fa-copy"></i><i class="fas fa-check"></i></span></button><code class="language-dockerfile"># Usa uma imagem base oficial do Python
FROM python:3.11-slim

# Define o diret√≥rio de trabalho dentro do container
WORKDIR /app

# Copia o arquivo de depend√™ncias e instala
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copia o restante do c√≥digo da aplica√ß√£o
COPY . .

# Exp√µe a porta 5000 (apenas para documenta√ß√£o)
EXPOSE 5000

# Comando padr√£o que ser√° executado ao iniciar o container
CMD ["python", "app.py"]</code></pre>

                    <h3 class="text-2xl font-semibold mt-8">1.4 Docker Compose (B√°sico)</h3>
                    <p>Use o Docker Compose para orquestrar m√∫ltiplos containers localmente.</p>
                    <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-auto"><button class="copy-btn"><span class="copy-btn-icon"><i class="fas fa-copy"></i><i class="fas fa-check"></i></span></button><code class="language-yaml">version: '3.8'
services:
  # Servi√ßo da sua aplica√ß√£o web
  web:
    build: .
    ports:
      - "8000:5000"
    volumes:
      - .:/app
    environment:
      - FLASK_ENV=development
    depends_on:
      - redis

  # Servi√ßo do banco de dados Redis
  redis:
    image: "redis:alpine"</code></pre>
                </section>

                <section id="modulo2" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üß± M√≥dulo 2: EC2 (Elastic Compute Cloud)</h2>
                    <h3 class="text-2xl font-semibold mt-6">2.1 O que √© EC2?</h3>
                    <p>Pense no <strong>EC2</strong> como o servi√ßo de <strong>aluguel de servidores virtuais</strong> na nuvem da AWS. √â a base da computa√ß√£o na AWS. Em vez de comprar um servidor f√≠sico, voc√™ "aluga" poder computacional e paga apenas pelo tempo que usa.</p>
                    <h4 class="text-xl font-semibold mt-4">O que voc√™ pode fazer com uma inst√¢ncia EC2?</h4>
                    <ul>
                        <li>Instalar e rodar qualquer software (como um servidor web Nginx, um banco de dados MySQL ou o pr√≥prio Docker).</li>
                        <li>Hospedar o back-end de uma aplica√ß√£o web.</li>
                        <li>Processar grandes volumes de dados.</li>
                        <li>Servir como um "host" para seus containers Docker.</li>
                    </ul>

                    <h3 class="text-2xl font-semibold mt-8">2.2 Exemplo Melhorado: Preparando um Servidor para Rodar um Container</h3>
                     <p>Neste exemplo, vamos lan√ßar uma inst√¢ncia EC2, instalar o Docker nela e rodar um container de uma aplica√ß√£o web. Este √© o m√©todo "manual" e serve de base para entender o que o ECS far√° por n√≥s mais tarde.</p>
                    <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-auto"><button class="copy-btn"><span class="copy-btn-icon"><i class="fas fa-copy"></i><i class="fas fa-check"></i></span></button><code class="language-bash"># 1. Atualiza a lista de pacotes do sistema
sudo apt update -y

# 2. Instala o Docker
sudo apt install -y docker.io

# 3. Inicia o servi√ßo do Docker e o habilita para iniciar com o boot
sudo systemctl start docker
sudo systemctl enable docker

# 4. Adiciona seu usu√°rio 'ubuntu' ao grupo 'docker' para n√£o precisar usar 'sudo'
sudo usermod -aG docker $USER
newgrp docker # Aplica a mudan√ßa de grupo na sess√£o atual
</code></pre>
                     <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-auto mt-4"><button class="copy-btn"><span class="copy-btn-icon"><i class="fas fa-copy"></i><i class="fas fa-check"></i></span></button><code class="language-bash"># Testa a instala√ß√£o
docker run hello-world

# Roda uma aplica√ß√£o web de exemplo
# -d: roda em background
# -p 80:5000: mapeia a porta 80 do servidor para a porta 5000 do container
docker run -d -p 80:5000 --name minha-app-web kennethreitz/httpbin
</code></pre>
                    <p class="mt-2"><strong>Resultado</strong>: Abra seu navegador e acesse o IP P√∫blico da sua inst√¢ncia EC2. Voc√™ ver√° a p√°gina da aplica√ß√£o <code>httpbin</code> funcionando!</p>
                </section>

                <section id="modulo3" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üì¶ M√≥dulo 3: Amazon ECR (Elastic Container Registry)</h2>
                    <h3 class="text-2xl font-semibold mt-6">3.1 O que √© ECR?</h3>
                    <p>Pense no <strong>ECR</strong> como a <strong>"garagem" privada da AWS para suas imagens Docker</strong>. Enquanto o Docker Hub √© um registro p√∫blico, o ECR √© o seu registro privado, seguro e totalmente integrado ao ecossistema da AWS.</p>

                    <h3 class="text-2xl font-semibold mt-8">3.2 Exemplo: Construindo e Enviando uma Imagem para o ECR</h3>
                     <p>Neste exemplo, vamos pegar uma aplica√ß√£o simples, criar uma imagem Docker para ela e public√°-la no nosso ECR.</p>
                     <pre class="bg-gray-800 text-white p-4 rounded-lg overflow-auto"><button class="copy-btn"><span class="copy-btn-icon"><i class="fas fa-copy"></i><i class="fas fa-check"></i></span></button><code class="language-bash"># Vari√°veis para facilitar (substitua com seus valores)
export AWS_ACCOUNT_ID=$(aws sts get-caller-identity --query Account --output text)
export AWS_REGION=us-east-1
export REPOSITORY_NAME=minha-aplicacao-web
export IMAGE_TAG=latest

# 1. Autentica o Docker no registro ECR
aws ecr get-login-password --region $AWS_REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$AWS_REGION.amazonaws.com

# 2. Constr√≥i a imagem Docker localmente
docker build -t $REPOSITORY_NAME:$IMAGE_TAG .

# 3. Adiciona a "tag" completa do ECR √† imagem
docker tag $REPOSITORY_NAME:$IMAGE_TAG $AWS_ACCOUNT_ID.dkr.ecr.$AWS_REGION.amazonaws.com/$REPOSITORY_NAME:$IMAGE_TAG

# 4. Envia a imagem para o ECR
docker push $AWS_ACCOUNT_ID.dkr.ecr.$AWS_REGION.amazonaws.com/$REPOSITORY_NAME:$IMAGE_TAG
</code></pre>
                </section>

                <section id="modulo4" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">‚öôÔ∏è M√≥dulo 4: ECS com Launch Type EC2</h2>
                    <h3 class="text-2xl font-semibold mt-6">4.1 O que √© ECS? (E os Conceitos Principais)</h3>
                    <p>Pense no <strong>ECS (Elastic Container Service)</strong> como o <strong>"maestro" ou "gerente" dos seus containers</strong>. Voc√™ j√° tem os servidores (EC2) e as imagens (ECR). O trabalho do ECS √© pegar essas imagens e execut√°-las nos servidores de forma inteligente, garantindo que sua aplica√ß√£o esteja sempre no ar, saud√°vel e escal√°vel.</p>
                     <ul>
                         <li><strong>Cluster</strong>: O "palco" onde seus containers v√£o rodar.</li>
                         <li><strong>Task Definition</strong>: A "receita de bolo" da sua aplica√ß√£o (imagem, CPU, mem√≥ria, portas).</li>
                         <li><strong>Task</strong>: Uma inst√¢ncia em execu√ß√£o de uma Task Definition.</li>
                         <li><strong>Service</strong>: Garante que um n√∫mero desejado de Tasks esteja sempre rodando e se integra com Load Balancers.</li>
                     </ul>
                    <h3 class="text-2xl font-semibold mt-8">4.2 Exemplo: Fazendo o Deploy com ECS + EC2</h3>
                    <p>Agora vamos juntar tudo: usar o ECS para pegar nossa imagem do ECR e rod√°-la em um cluster de inst√¢ncias EC2. Os passos abaixo s√£o um resumo do que √© feito no Console da AWS.</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li><strong>Criar o Cluster ECS</strong>: No console do ECS, crie um novo cluster do tipo "EC2 Linux + Networking", definindo o tipo e a quantidade de inst√¢ncias desejada (ex: 2 inst√¢ncias `t2.micro`).</li>
                        <li><strong>Criar a Task Definition</strong>: Crie uma defini√ß√£o de tarefa, especifique o launch type `EC2`, aponte para a URI da sua imagem no ECR e mapeie as portas (ex: porta `5000` do container).</li>
                        <li><strong>Criar o Servi√ßo</strong>: Dentro do cluster, crie um servi√ßo, associe a Task Definition criada, defina o n√∫mero de tarefas desejadas (ex: 2 para alta disponibilidade) e configure um Application Load Balancer para distribuir o tr√°fego.</li>
                    </ol>
                    <p class="mt-4"><strong>Resultado Final</strong>: O ECS ir√° agendar a execu√ß√£o de duas tarefas nas suas inst√¢ncias EC2. Cada tarefa ir√° puxar a imagem do ECR. O Load Balancer distribuir√° o tr√°fego entre elas. Se uma inst√¢ncia ou tarefa falhar, o ECS a substituir√° automaticamente.</p>
                </section>

                <section id="modulo5" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üìà M√≥dulo 5: Auto Scaling em ECS</h2>
                    <ul>
                        <li><strong>Service Auto Scaling</strong>: Ajusta o n√∫mero de <em>tarefas</em> com base em m√©tricas como uso de CPU ou mem√≥ria do servi√ßo.</li>
                        <li><strong>Cluster Auto Scaling</strong>: Usa <em>Capacity Providers</em> para ajustar o n√∫mero de <em>inst√¢ncias EC2</em> no cluster. Se o servi√ßo precisar de mais tarefas, mas n√£o houver capacidade de EC2, o cluster adicionar√° mais m√°quinas.</li>
                    </ul>
                </section>
                
                <section id="modulo6" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üîÑ M√≥dulo 6: CI/CD com GitHub Actions + ECS</h2>
                    <p>Um workflow de CI/CD automatiza o processo de build e deploy. A cada `push` no GitHub:</p>
                    <ol class="list-decimal list-inside space-y-2">
                        <li>A imagem Docker √© constru√≠da.</li>
                        <li>A imagem √© enviada para o ECR com uma nova tag.</li>
                        <li>Uma nova revis√£o da Task Definition √© criada.</li>
                        <li>O Servi√ßo ECS √© atualizado para usar a nova Task Definition, realizando um deploy sem downtime.</li>
                    </ol>
                </section>

                <section id="modulo7" class="mb-12">
                     <h2 class="text-3xl font-bold border-b pb-2 mb-6">‚òÅÔ∏è M√≥dulo 7: ECS com Fargate (Serverless)</h2>
                     <p>Fargate √© uma alternativa ao modo EC2. Com Fargate, voc√™ n√£o gerencia nenhum servidor.</p>
                     <h4 class="text-xl font-semibold mt-4">Diferen√ßas Chave: ECS EC2 vs. Fargate</h4>
                     <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th class="py-2 px-4 border">Caracter√≠stica</th>
                                    <th class="py-2 px-4 border">ECS com EC2</th>
                                    <th class="py-2 px-4 border">ECS com Fargate (Serverless)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td class="border px-4 py-2"><strong>Gerenciamento</strong></td><td class="border px-4 py-2"><strong>Voc√™</strong> gerencia as inst√¢ncias EC2.</td><td class="border px-4 py-2"><strong>AWS</strong> gerencia a infraestrutura.</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Custo</strong></td><td class="border px-4 py-2">Pago pela inst√¢ncia EC2 inteira.</td><td class="border px-4 py-2">Pago por vCPU e mem√≥ria usados pela tarefa.</td></tr>
                                <tr><td class="border px-4 py-2"><strong>Controle</strong></td><td class="border px-4 py-2">Maior controle sobre a inst√¢ncia.</td><td class="border px-4 py-2">Menos controle, mais simplicidade.</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section id="modulo8" class="mb-12">
                    <h2 class="text-3xl font-bold border-b pb-2 mb-6">üé® M√≥dulo 8: CI/CD Avan√ßado (Blue/Green, Canary)</h2>
                    <ul>
                        <li><strong>Blue/Green Deployment</strong>: Uma nova vers√£o (Green) √© implantada ao lado da vers√£o atual (Blue). Ap√≥s os testes, o tr√°fego √© instantaneamente desviado para a vers√£o Green. Permite rollback imediato.</li>
                        <li><strong>Canary Deployment</strong>: A nova vers√£o √© liberada para uma pequena porcentagem de usu√°rios (ex: 10%). Se as m√©tricas estiverem boas, a libera√ß√£o √© expandida gradualmente at√© 100%.</li>
                    </ul>
                </section>

            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Funcionalidade do bot√£o de copiar ---
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const code = btn.parentElement.querySelector('code').innerText;
                    navigator.clipboard.writeText(code).then(() => {
                        const iconContainer = btn.querySelector('.copy-btn-icon');
                        iconContainer.classList.add('copied');
                        setTimeout(() => {
                           iconContainer.classList.remove('copied');
                        }, 2000);
                    }).catch(err => {
                        console.error('Falha ao copiar: ', err);
                    });
                });
            });

            // --- Funcionalidade de scroll suave e menu ativo ---
            const navLinks = document.querySelectorAll('.sidebar-link');
            const sections = document.querySelectorAll('section');

            const makeLinkActive = (id) => {
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                    }
                });
            };

            // Scroll suave ao clicar no menu
            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    document.querySelector(targetId).scrollIntoView({
                        behavior: 'smooth'
                    });
                    // Atualiza o hash na URL sem pular
                    if(history.pushState) {
                        history.pushState(null, null, targetId);
                    } else {
                        location.hash = targetId;
                    }
                });
            });

            // Highlight do menu ao rolar a p√°gina
            const observerOptions = {
                root: null,
                rootMargin: "0px",
                threshold: 0.3 // 30% da se√ß√£o vis√≠vel
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        makeLinkActive(entry.target.id);
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });

            // Highlight do primeiro item ao carregar
            if (window.location.hash) {
                makeLinkActive(window.location.hash.substring(1));
            } else {
                 makeLinkActive(sections[0].id);
            }
        });
    </script>

</body>
</html>

